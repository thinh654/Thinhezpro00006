local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UIS = game:GetService("UserInputService")
local Lighting = game:GetService("Lighting")
local Workspace = game:GetService("Workspace")

local pl = Players.LocalPlayer
local ch, hum, hrp
local SECRET_KEY = "thinh"
local omniMode = false

-- ===== H·ªÜ TH·ªêNG T√çNH NƒÇNG T·ªîNG L·ª∞C =====
local omniConfig = {
    flySpeed = 150, 
    flingForce = 1e10, 
    isKillAll = false,
    isAntiRagdoll = true,
    isAutoToxic = false, -- AI t·ª± ƒë·ªông c√† kh·ªãa
    isServerHop = false,
    viewTarget = nil
}

local conns = {}

local function setup(newCh)
    ch = newCh or pl.Character or pl.CharacterAdded:Wait()
    hum = ch:WaitForChild("Humanoid")
    hrp = ch:WaitForChild("HumanoidRootPart")
    -- Anti-Ragdoll & God State
    hum.BreakJointsOnDeath = false
    hum:SetStateEnabled(Enum.HumanoidStateType.FallingDown, false)
end
pl.CharacterAdded:Connect(setup); setup()

-- ===== AI CHAT C√Ä KH·ªäA (TOXIC SYSTEM) =====
local toxicLines = {
    "V≈© tr·ª• n√†y qu√° nh·ªè b√© ƒë·ªëi v·ªõi t√¥i v√† Thinh!",
    "M·ª•c ti√™u ƒë√£ b·ªã x√≥a s·ªï kh·ªèi d√≤ng th·ªùi gian.",
    "ƒê·ª´ng c·ªë ch·ªëng l·∫°i th·ª±c th·ªÉ Omni.",
    "Server n√†y hi·ªán thu·ªôc quy·ªÅn s·ªü h·ªØu c·ªßa V8 AI.",
    "Ph√°t hi·ªán sinh v·∫≠t y·∫øu ƒëu·ªëi, ƒëang ti·∫øn h√†nh thanh tr·ª´ng..."
}

local function aiToxic()
    if omniConfig.isAutoToxic then
        local msg = toxicLines[math.random(1, #toxicLines)]
        game:GetService("ReplicatedStorage").DefaultChatSystemChatEvents.SayMessageRequest:FireServer(msg, "All")
    end
end

-- ===== CH·ª®C NƒÇNG SI√äU C·∫§P =====

-- 1. Kill All (Qu√©t s·∫°ch server)
local function killAll()
    omniConfig.isKillAll = not omniConfig.isKillAll
    if omniConfig.isKillAll then
        conns["KillAll"] = RunService.Heartbeat:Connect(function()
            for _, p in pairs(Players:GetPlayers()) do
                if p ~= pl and p.Character and p.Character:FindFirstChild("HumanoidRootPart") then
                    hrp.CFrame = p.Character.HumanoidRootPart.CFrame
                    hrp.Velocity = Vector3.new(0, omniConfig.flingForce, 0)
                end
            end
        end)
    else
        if conns["KillAll"] then conns["KillAll"]:Disconnect() end
    end
    return omniConfig.isKillAll
end

-- 2. Spectate (Theo d√µi m·ª•c ti√™u)
local function view(targetName)
    for _, p in pairs(Players:GetPlayers()) do
        if p.Name:lower():find(targetName) then
            Workspace.CurrentCamera.CameraSubject = p.Character.Humanoid
            return "ƒêang quan s√°t: " .. p.Name
        end
    end
end

-- ===== B·ªò N√ÉO OMNIVERSE =====
local function aiOmni(input)
    local t = input:lower()
    if t == SECRET_KEY then omniMode = true; return "üåå OMNIVERSE: ƒê√£ m·ªü kh√≥a quy·ªÅn nƒÉng t·ªëi th∆∞·ª£ng." end
    if not omniMode then return "‚ùå C·∫ßn Key 'thinh'." end

    if t:find("killall") or t:find("di·ªát h·∫øt") then
        local s = killAll()
        return s and "üåå AI: ƒêang thanh tr·ª´ng to√†n b·ªô server..." or "üåå AI: ƒê√£ d·ª´ng s√°t ph·∫°t."
    end

    if t:find("chat") or t:find("kh·ªãa") then
        omniConfig.isAutoToxic = not omniConfig.isAutoToxic
        return "üåå AI Toxic: " .. (omniConfig.isAutoToxic and "B·∫¨T" or "T·∫ÆT")
    end

    if t:find("xem") or t:find("view") then
        local name = t:gsub("xem ", ""):gsub("view ", "")
        return view(name)
    end

    if t:find("hop") or t:find("ƒë·ªïi server") then
        local Http = game:GetService("HttpService")
        local TPS = game:GetService("TeleportService")
        local Servers = Http:JSONDecode(game:HttpGet("https://games.roblox.com/v1/games/"..game.PlaceId.."/servers/Public?sortOrder=Asc&limit=100"))
        for _, s in pairs(Servers.data) do
            if s.playing < s.maxPlayers and s.id ~= game.JobId then
                TPS:TeleportToPlaceInstance(game.PlaceId, s.id, pl)
            end
        end
    end

    return "üåå L·ªánh: killall, chat, xem [t√™n], hop, void, warp"
end

-- ===== GIAO DI·ªÜN ƒêA V≈® TR·ª§ (130PX - SI√äU M·ªéNG) =====
local gui = Instance.new("ScreenGui", pl.PlayerGui); gui.ResetOnSpawn = false
local menu = Instance.new("Frame", gui)
menu.Size = UDim2.new(0, 580, 0, 130); menu.Position = UDim2.new(0.5, -290, 0.5, -65)
menu.BackgroundColor3 = Color3.fromRGB(0, 0, 0); menu.Visible = false; Instance.new("UICorner", menu)
Instance.new("UIStroke", menu).Color = Color3.fromRGB(255, 0, 0) -- Vi·ªÅn ƒë·ªè c·∫£nh b√°o

local scroll = Instance.new("ScrollingFrame", menu)
scroll.Size = UDim2.new(0.4, 0, 0.85, 0); scroll.Position = UDim2.new(0.02, 0, 0.07, 0); scroll.BackgroundTransparency = 1; scroll.ScrollBarThickness = 0
Instance.new("UIListLayout", scroll).Padding = UDim.new(0, 2)

local aiBox = Instance.new("Frame", menu)
aiBox.Size = UDim2.new(0.55, 0, 0.85, 0); aiBox.Position = UDim2.new(0.43, 0, 0.07, 0); aiBox.BackgroundColor3 = Color3.fromRGB(10, 10, 10); Instance.new("UICorner", aiBox)

local log = Instance.new("ScrollingFrame", aiBox)
log.Size = UDim2.new(1, -10, 0.7, 0); log.BackgroundTransparency = 1; Instance.new("UIListLayout", log)

local input = Instance.new("TextBox", aiBox)
input.Size = UDim2.new(1, 0, 0.3, 0); input.Position = UDim2.new(0, 0, 0.7, 0); input.BackgroundColor3 = Color3.fromRGB(30, 0, 0); input.TextColor3 = Color3.new(1, 0, 0); input.Text = "L·ªÜNH OMNI..."

local function b(txt, f)
    local btn = Instance.new("TextButton", scroll)
    btn.Size = UDim2.new(1, 0, 0, 20); btn.Text = txt; btn.BackgroundColor3 = Color3.fromRGB(20, 20, 20); btn.TextColor3 = Color3.new(1,0,0); btn.Font = Enum.Font.Code; Instance.new("UICorner", btn)
    btn.MouseButton1Click:Connect(f)
end

b("üî• KILL ALL SERVER", function() aiOmni("killall") end)
b("üí¨ AUTO TOXIC (ON/OFF)", function() aiOmni("chat") end)
b("üöÄ SERVER HOP", function() aiOmni("hop") end)
b("üëÅÔ∏è UNVIEW", function() Workspace.CurrentCamera.CameraSubject = hum end)
b("üõ°Ô∏è ANTI-ADMIN", function() aiOmni("admin") end)

input.FocusLost:Connect(function(e)
    if e then
        local res = aiOmni(input.Text)
        local l = Instance.new("TextLabel", log); l.Size = UDim2.new(1,0,0,15); l.Text = res; l.TextColor3 = Color3.new(1,0,0); l.BackgroundTransparency = 1; l.TextXAlignment = "Left"; l.TextSize = 10
        input.Text = ""
    end
end)

local v8 = Instance.new("TextButton", gui); v8.Size = UDim2.new(0, 40, 0, 40); v8.Position = UDim2.new(0, 10, 0.1, 0); v8.Text = "üî•"; v8.BackgroundColor3 = Color3.fromRGB(255, 0, 0); Instance.new("UICorner", v8).CornerRadius = UDim.new(1,0)
v8.MouseButton1Click:Connect(function() menu.Visible = not menu.Visible end)
